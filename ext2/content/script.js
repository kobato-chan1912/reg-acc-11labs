let scripts=["content/core_helpers.js","content/communication_helpers.js","content/captcha/recaptcha/interceptor.js","content/captcha/recaptcha/hunter.js"],CaptchaProcessors=(getConfig().then(e=>{for(var t of scripts){var a=document.createElement("script");a.src=chrome.runtime.getURL(t),(document.head||document.documentElement).prepend(a)}}),{list:{},register:function(e){this.list[e.captchaType]=e},get:function(e){return this.list[e]}}),CAPTCHA_WIDGETS_LOOP;function doActionsOnSuccess(a){let r=getWidgetInfo(a.request.captchaType,a.request.widgetId),o=CaptchaProcessors.get(a.request.captchaType);o.onSolved(r,a.response),getConfig().then(()=>{var e,t=o.getCallback(r);t&&((e=document.createElement("textarea")).id="twocaptcha-callback-trigger",e.setAttribute("data-function",t),e.value=a.response,document.body.appendChild(e))})}function doActionsOnFail(e){var t=getWidgetInfo(e.request.captchaType,e.request.widgetId),e=CaptchaProcessors.get(e.request.captchaType);try{e.onFail(t)}catch(e){}}function createSolverButton(a,r){"normal"!==a&&(a[0].toUpperCase(),a.slice(1));var e=chrome.i18n.getMessage("solveWithAchiCaptcha");let o=$(`
        <div class="captcha-solver" data-state="ready" data-captcha-type="${a}" data-widget-id="${r}">
            <div class="captcha-solver-image" style="background-color: rgb(25, 28, 27);">
                <img src="${chrome.runtime.getURL("/assets/icon/16.png")}">
            </div>
            <div class="captcha-solver-info" style="font-size: initial;color: rgb(0, 0, 0);">${e}</div>
        </div>
    `);return o.click(function(e){if(e.stopPropagation(),["ready","error"].includes(o.attr("data-state"))){if(o[0].dataset.countErrors&&o[0].dataset.disposable)return changeSolverButtonState(o,"error",a,"EXPIRED");changeSolverButtonState(o,"solving",a,chrome.i18n.getMessage("solving"));let t=getWidgetInfo(a,r);getConfig().then(function(e){e=CaptchaProcessors.get(a).getParams(t,e);try{chrome.runtime.sendMessage({name:"content",action:"solve",captchaType:a,widgetId:r,params:e},function(e){var t=getSolverButton(e.request.captchaType,e.request.widgetId);void 0===e.error?(changeSolverButtonState(t,"solved",e.request.captchaType,chrome.i18n.getMessage("solved")),doActionsOnSuccess(e)):(doActionsOnFail(e),changeSolverButtonState(t,"error",e.request.captchaType,e.error))})}catch(e){resetCaptchaWidget(a,r)}})}}),o}function changeSolverButtonState(a,r,o,s){getConfig().then(e=>{let t="normal"===o?"Image":o[0].toUpperCase()+o.slice(1);t=t.replace("_"," "),a.attr("data-state",r),a.find(".captcha-solver-info").text(t+" "+s),"error"===r?(a[0].dataset.countErrors=parseInt(a[0].dataset.countErrors||0)+1,a.find(".captcha-solver-image img").attr("src",chrome.runtime.getURL("assets/icon/16error.png")),e.refreshPage&&(e.deleteCoockie&&clearHOnlySessionCookie(),location.reload())):"solving"===r?a.find(".captcha-solver-image img").attr("src",chrome.runtime.getURL("assets/icon/loading.gif")):"solved"===r&&a.find(".captcha-solver-image img").attr("src",chrome.runtime.getURL("assets/icon/success.gif"))})}function getSolverButton(e,t){return $(".captcha-solver[data-captcha-type="+e+"][data-widget-id="+t+"]")}function getWidgetInfo(e,t){e=$("head").find("captcha-widget[data-captcha-type="+e+"][data-widget-id="+t+"]");return e.length?prepareWidgetInfo(e[0].dataset):null}function prepareWidgetInfo(e){var t,a={};for(t in e)a[t]=e[t],"null"===a[t]&&(a[t]=null),"false"===a[t]&&(a[t]=!1),"true"===a[t]&&(a[t]=!0);return a}function respondToWebPageMessage(e){var t=$("body > solver-ext-messages > solver-ext-message[data-message-id="+e.request.messageId+"]");t.length&&(e.error?setWebPageMessageResponse(t[0],{error:e.error}):setWebPageMessageResponse(t[0],{response:e.response}))}function setWebPageMessageResponse(e,t){e.dataset.response=encodeURIComponent(JSON.stringify(t))}CAPTCHA_WIDGETS_LOOP=setInterval(function(){getConfig().then(o=>{o&&o.isPluginEnabled&&null!==o.clientKey&&""!==o.clientKey&&$("head").find("captcha-widget").each(function(){var e,t,a=$(this),r=prepareWidgetInfo(a[0].dataset);r.reset?(getSolverButton(r.captchaType,r.widgetId).remove(),a.remove()):r.loaded||(e=CaptchaProcessors.get(r.captchaType)).canBeProcessed(r,o)&&(t=createSolverButton(r.captchaType,r.widgetId),e.attachButton(r,o,t),a[0].dataset.loaded=!0)})})},2e3);
